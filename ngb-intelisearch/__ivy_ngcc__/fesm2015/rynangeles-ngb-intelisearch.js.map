{"version":3,"file":"rynangeles-ngb-intelisearch.js","sources":["../../../projects/ngb-intelisearch/src/lib/ngb-intelisearch.service.ts","../../../projects/ngb-intelisearch/src/lib/ngb-intelisearch.component.ts","../../../projects/ngb-intelisearch/src/lib/ngb-intelisearch.module.ts","../../../projects/ngb-intelisearch/src/public-api.ts","../../../projects/ngb-intelisearch/src/rynangeles-ngb-intelisearch.ts"],"names":["_.filter","_.takeRight","_.map","_.last","filter","map","_.chain"],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgbIntelisearchService {\n\n  constructor() { }\n}\n","import { Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild } from '@angular/core';\nimport { Observable, Subject, merge, of } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, filter, map, switchMap, tap } from 'rxjs/operators';\nimport * as _ from 'lodash';\nimport { NgbTypeahead } from '@ng-bootstrap/ng-bootstrap';\n\nenum Token {\n  Logical,\n  Key,\n  Operator,\n  Value\n}\nenum KeyCode {\n  Enter = 13,\n  Backspace = 8\n};\n\nconst EnumLength = Enum => {\n  return Object.keys(Enum).map(val => Number(isNaN(Number(val)))).reduce((a, b) => a + b, 0);\n}\n\n@Component({\n  selector: 'ngb-intelisearch[name]',\n  templateUrl: './ngb-intelisearch.component.html',\n  styleUrls: ['./ngb-intelisearch.component.scss']\n})\nexport class NgbIntelisearchComponent implements OnInit {\n  @ViewChild('input', { static: false }) input: ElementRef;\n  @ViewChild('typehead', { static: false }) typehead: NgbTypeahead;\n  @Input() name: string;\n  @Input() keys: (value: any) => Observable<any>;\n  @Input() values: (value: any) => Observable<any>;\n  @Input() logical: (value: any) => Observable<any> = () => of([\n    { value: 'AND', label: 'AND' },\n    { value: 'OR', label: 'OR' }\n  ]);\n  @Input() comparison: (value: any) => Observable<any> = () => of([\n    { value: '=', label: 'equal' },\n    { value: '!=', label: 'not equal' },\n    { value: 'LIKE', label: 'contains' },\n    { value: '>', label: 'greater than' },\n    { value: '<', label: 'less than' }\n  ]);\n  @Output() search: EventEmitter<any> = new EventEmitter();\n  focus$ = new Subject<string>();\n  click$ = new Subject<string>();\n  searchTokens: any[];\n  tokens: any[] = [];\n  token: string[];\n  inputModel: string = '';\n\n  constructor() {\n    this.tokenSearch = this.tokenSearch.bind(this);\n  }\n\n  inputFormatter = (input: { value: string }) => input.value;\n\n  addToken() {\n    const token = this.tokens.length ? [] : [null];\n    this.tokens.push(token);\n    this.token = this.tokens[this.tokens.indexOf(token)];\n  }\n\n  ngOnInit() {\n    this.addToken();\n    this.getSearchTokens();\n  }\n\n  saveSearchTokens() {\n    const tokens = this.getSearchTokens();\n    tokens.push(_.filter(this.tokens, token => token.length));\n    window.localStorage.setItem(`sf:${this.name}`, JSON.stringify(_.takeRight(tokens, 5)));\n  }\n\n  getSearchTokens() {\n    const tokens = window.localStorage.getItem(`sf:${this.name}`);\n    this.searchTokens = JSON.parse(tokens) || [];\n    return this.searchTokens;\n  }\n\n  clearSearchTokens() {\n    window.localStorage.removeItem(`sf:${this.name}`);\n    this.getSearchTokens();\n  }\n\n  tokensToString(tokens) {\n    return _.map(tokens, i => i.join('')).join('&');\n  }\n\n  onSelectRecentSearch(tokens) {\n    this.tokens = tokens;\n    this.addToken();\n    this.search.emit(this.tokens);\n  }\n\n  getInputPlaceholder(token) {\n    let placeholder = 'Search';\n    switch (token.length) {\n      case Token.Logical:\n        placeholder = 'Seach Logical Operator';\n        break;\n      case Token.Key:\n        placeholder = 'Seach Key';\n        break;\n      case Token.Operator:\n        placeholder = 'Seach Comparison Operator';\n        break;\n      case Token.Value:\n        placeholder = 'Seach Value';\n        break;\n      default:\n        placeholder = 'Seach...';\n        break;\n    }\n    return placeholder;\n  }\n  /*\n  TODO:\n  inspect how tokens and queries produced\n  */\n  onTypeheadKeydown(evt?) {\n    const keyCode = (evt.which) ? evt.which : evt.keyCode;\n    switch (keyCode) {\n      case KeyCode.Enter:\n        if (this.inputModel.length > 0) {\n          evt.preventDefault();\n          this.search.emit([...this.tokens, [this.inputModel]]);\n        }\n        if (this.tokens.length > 1 && this.token.length === 0) {\n          evt.preventDefault();\n          this.search.emit(this.tokens);\n          this.saveSearchTokens();\n        }\n        break;\n      case KeyCode.Backspace:\n        if (!this.inputModel.length) {\n          evt.preventDefault();\n          this.input.nativeElement.blur();\n          if (!this.token.length && this.tokens.indexOf(this.token) !== 0) {\n            this.tokens.pop();\n            this.token = _.last(this.tokens);\n          }\n          this.inputModel = this.token.pop() || '';\n          if (this.tokens.length === 1 && this.token.length === 0) {\n            this.tokens.pop();\n            this.addToken();\n          }\n          setTimeout(() => this.input.nativeElement.focus());\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  tokenSearch() {\n    return (text$: Observable<string>) => {\n      const debouncedText$ = text$.pipe(debounceTime(200), distinctUntilChanged());\n      const clicksWithClosedPopup$ = this.click$.pipe(filter(() => !this.typehead.isPopupOpen()));\n      const inputFocus$ = this.focus$;\n      return merge(debouncedText$, inputFocus$, clicksWithClosedPopup$)\n        .pipe(\n          switchMap(term => {\n            let $observable: Observable<any>;\n            switch (this.token.length) {\n              case Token.Logical:\n                $observable = this.logical({ type: 'LOGICAL', property: null, term, count: 10 });\n                break;\n              case Token.Key:\n                $observable = this.keys({ type: 'KEY', property: null, term, count: 10 });\n                break;\n              case Token.Operator:\n                $observable = this.comparison({ type: 'COMPARISON', property: null, term, count: 10 });\n                break;\n              case Token.Value:\n                $observable = this.values({ type: 'VALUE', property: this.token[Token.Key], term, count: 10 });\n                break;\n              default:\n                $observable = of([]);\n                break;\n            }\n            return $observable.pipe(map(list => ({ list, term })));\n          }),\n          map(({ list, term }) => {\n            return _.chain(list)\n              .filter(item => item.toString().toLowerCase().indexOf(term.toLowerCase()) >= 0)\n              .uniq()\n              .slice(0, 10)\n              .value();\n          })\n        );\n    }\n  }\n\n  tokenHandler(evt) {\n    evt.preventDefault();\n    const { value } = evt.item;\n    this.input.nativeElement.blur();\n    this.token.push(value);\n    this.inputModel = '';\n    if (this.token.indexOf(value) === Token.Value) {\n      this.addToken();\n    }\n    setTimeout(() => this.input.nativeElement.focus());\n  }\n\n  selectToken(idx) {\n    const token = this.tokens[idx];\n    if (token.length === EnumLength(Token)) {\n      this.input.nativeElement.blur();\n      this.tokens.pop();\n      this.token = token;\n      this.inputModel = this.token.pop();\n      setTimeout(() => this.input.nativeElement.focus());\n    }\n  }\n\n  removeToken(idx) {\n    this.tokens.splice(idx, 1);\n    this.search.emit(this.tokens);\n  }\n\n  clearTokens() {\n    this.tokens.length = 0;\n    this.search.emit(this.tokens);\n    this.addToken();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\nimport { NgbIntelisearchComponent } from './ngb-intelisearch.component';\n\n\n\n@NgModule({\n  declarations: [NgbIntelisearchComponent],\n  imports: [\n    BrowserModule,\n    NgbModule\n  ],\n  exports: [NgbIntelisearchComponent]\n})\nexport class NgbIntelisearchModule { }\n","/*\n * Public API Surface of ngb-intelisearch\n */\n\nexport * from './lib/ngb-intelisearch.service';\nexport * from './lib/ngb-intelisearch.component';\nexport * from './lib/ngb-intelisearch.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]}